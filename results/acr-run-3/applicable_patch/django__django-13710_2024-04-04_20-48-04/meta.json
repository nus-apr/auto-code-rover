{
    "task_id": "django__django-13710",
    "setup_info": {
        "repo_path": "/media/media0/yuntong/SWE-bench/testbed/django__django/setup_django__django__4.0",
        "env_name": "setup_django__django__4.0",
        "pre_install": [],
        "install": "python -m pip install -e .",
        "test_cmd": "./tests/runtests.py --verbosity 2 admin_inlines.tests"
    },
    "task_info": {
        "instance_id": "django__django-13710",
        "base_commit": "1bd6a7a0acc11e249fca11c017505ad39f15ebf6",
        "hints_text": "Please push your patch as a \u200bDjango pull request.",
        "created_at": "2020-11-23T04:39:05Z",
        "test_patch": "diff --git a/tests/admin_inlines/tests.py b/tests/admin_inlines/tests.py\n--- a/tests/admin_inlines/tests.py\n+++ b/tests/admin_inlines/tests.py\n@@ -967,6 +967,55 @@ def test_extra_inlines_are_not_shown(self):\n class TestVerboseNameInlineForms(TestDataMixin, TestCase):\n     factory = RequestFactory()\n \n+    def test_verbose_name_inline(self):\n+        class NonVerboseProfileInline(TabularInline):\n+            model = Profile\n+            verbose_name = 'Non-verbose childs'\n+\n+        class VerboseNameProfileInline(TabularInline):\n+            model = VerboseNameProfile\n+            verbose_name = 'Childs with verbose name'\n+\n+        class VerboseNamePluralProfileInline(TabularInline):\n+            model = VerboseNamePluralProfile\n+            verbose_name = 'Childs with verbose name plural'\n+\n+        class BothVerboseNameProfileInline(TabularInline):\n+            model = BothVerboseNameProfile\n+            verbose_name = 'Childs with both verbose names'\n+\n+        modeladmin = ModelAdmin(ProfileCollection, admin_site)\n+        modeladmin.inlines = [\n+            NonVerboseProfileInline,\n+            VerboseNameProfileInline,\n+            VerboseNamePluralProfileInline,\n+            BothVerboseNameProfileInline,\n+        ]\n+        obj = ProfileCollection.objects.create()\n+        url = reverse('admin:admin_inlines_profilecollection_change', args=(obj.pk,))\n+        request = self.factory.get(url)\n+        request.user = self.superuser\n+        response = modeladmin.changeform_view(request)\n+        self.assertNotContains(response, 'Add another Profile')\n+        # Non-verbose model.\n+        self.assertContains(response, '<h2>Non-verbose childss</h2>')\n+        self.assertContains(response, 'Add another Non-verbose child')\n+        self.assertNotContains(response, '<h2>Profiles</h2>')\n+        # Model with verbose name.\n+        self.assertContains(response, '<h2>Childs with verbose names</h2>')\n+        self.assertContains(response, 'Add another Childs with verbose name')\n+        self.assertNotContains(response, '<h2>Model with verbose name onlys</h2>')\n+        self.assertNotContains(response, 'Add another Model with verbose name only')\n+        # Model with verbose name plural.\n+        self.assertContains(response, '<h2>Childs with verbose name plurals</h2>')\n+        self.assertContains(response, 'Add another Childs with verbose name plural')\n+        self.assertNotContains(response, '<h2>Model with verbose name plural only</h2>')\n+        # Model with both verbose names.\n+        self.assertContains(response, '<h2>Childs with both verbose namess</h2>')\n+        self.assertContains(response, 'Add another Childs with both verbose names')\n+        self.assertNotContains(response, '<h2>Model with both - plural name</h2>')\n+        self.assertNotContains(response, 'Add another Model with both - name')\n+\n     def test_verbose_name_plural_inline(self):\n         class NonVerboseProfileInline(TabularInline):\n             model = Profile\n",
        "repo": "django/django",
        "problem_statement": "Use Admin Inline verbose_name as default for Inline verbose_name_plural\nDescription\n\t\nDjango allows specification of a verbose_name and a verbose_name_plural for Inline classes in admin views. However, verbose_name_plural for an Inline is not currently based on a specified verbose_name. Instead, it continues to be based on the model name, or an a verbose_name specified in the model's Meta class. This was confusing to me initially (I didn't understand why I had to specify both name forms for an Inline if I wanted to overrule the default name), and seems inconsistent with the approach for a model's Meta class (which does automatically base the plural form on a specified verbose_name). I propose that verbose_name_plural for an Inline class should by default be based on the verbose_name for an Inline if that is specified.\nI have written a patch to implement this, including tests. Would be happy to submit that.\n",
        "version": "4.0",
        "FAIL_TO_PASS": [
            "test_verbose_name_inline (admin_inlines.tests.TestVerboseNameInlineForms)"
        ],
        "PASS_TO_PASS": [
            "#18263 -- Make sure hidden fields don't get a column in tabular inlines",
            "A model form with a form field specified (TitleForm.title1) should have",
            "Admin inline `readonly_field` shouldn't invoke parent ModelAdmin callable",
            "Admin inline should invoke local callable when its name is listed in readonly_fields",
            "An object can be created with inlines when it inherits another class.",
            "Autogenerated many-to-many inlines are displayed correctly (#13407)",
            "Bug #13174.",
            "Field names are included in the context to output a field-specific",
            "Inlines `show_change_link` disabled by default.",
            "Inlines `show_change_link` disabled for unregistered models.",
            "Inlines `show_change_link` for registered models when enabled.",
            "Inlines without change permission shows field inputs on add form.",
            "Multiple inlines with related_name='+' have correct form prefixes.",
            "Regression for #9362",
            "SomeChildModelForm.__init__() overrides the label of a form field.",
            "Tabular inlines use ModelForm.Meta.help_texts and labels for read-only",
            "The \"View on Site\" link is correct for locales that use thousand",
            "The \"View on Site\" link is correct for models with a custom primary key",
            "The inlines' model field help texts are displayed when using both the",
            "can_delete should be passed to inlineformset factory.",
            "min_num and extra determine number of forms.",
            "non_field_errors are displayed correctly, including the correct value",
            "test_add_url_not_allowed (admin_inlines.tests.TestReadOnlyChangeViewInlinePermissions)",
            "test_all_inline_media (admin_inlines.tests.TestInlineMedia)",
            "test_both_verbose_names_inline (admin_inlines.tests.TestVerboseNameInlineForms)",
            "test_custom_form_tabular_inline_extra_field_label (admin_inlines.tests.TestInline)",
            "test_custom_get_extra_form (admin_inlines.tests.TestInline)",
            "test_custom_min_num (admin_inlines.tests.TestInline)",
            "test_deleting_inline_with_protected_delete_does_not_validate (admin_inlines.tests.TestInlineProtectedOnDelete)",
            "test_extra_inlines_are_not_shown (admin_inlines.tests.TestReadOnlyChangeViewInlinePermissions)",
            "test_get_to_change_url_is_allowed (admin_inlines.tests.TestReadOnlyChangeViewInlinePermissions)",
            "test_inline_add_fk_add_perm (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_add_fk_noperm (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_add_m2m_add_perm (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_add_m2m_noperm (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_add_m2m_view_only_perm (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_change_fk_add_change_perm (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_change_fk_add_perm (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_change_fk_all_perms (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_change_fk_change_del_perm (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_change_fk_change_perm (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_change_fk_noperm (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_change_m2m_add_perm (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_change_m2m_change_perm (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_change_m2m_noperm (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_change_m2m_view_only_perm (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_delete_buttons_are_not_shown (admin_inlines.tests.TestReadOnlyChangeViewInlinePermissions)",
            "test_inline_editable_pk (admin_inlines.tests.TestInline)",
            "test_inline_media_only_base (admin_inlines.tests.TestInlineMedia)",
            "test_inline_media_only_inline (admin_inlines.tests.TestInlineMedia)",
            "test_inline_nonauto_noneditable_inherited_pk (admin_inlines.tests.TestInline)",
            "test_inline_nonauto_noneditable_pk (admin_inlines.tests.TestInline)",
            "test_inline_primary (admin_inlines.tests.TestInline)",
            "test_inlines_are_rendered_as_read_only (admin_inlines.tests.TestReadOnlyChangeViewInlinePermissions)",
            "test_inlines_plural_heading_foreign_key (admin_inlines.tests.TestInline)",
            "test_inlines_singular_heading_one_to_one (admin_inlines.tests.TestInline)",
            "test_main_model_is_rendered_as_read_only (admin_inlines.tests.TestReadOnlyChangeViewInlinePermissions)",
            "test_non_editable_custom_form_tabular_inline_extra_field_label (admin_inlines.tests.TestInline)",
            "test_post_to_change_url_not_allowed (admin_inlines.tests.TestReadOnlyChangeViewInlinePermissions)",
            "test_stacked_inline_edit_form_contains_has_original_class (admin_inlines.tests.TestInline)",
            "test_submit_line_shows_only_close_button (admin_inlines.tests.TestReadOnlyChangeViewInlinePermissions)",
            "test_verbose_name_plural_inline (admin_inlines.tests.TestVerboseNameInlineForms)"
        ],
        "environment_setup_commit": "475cffd1d64c690cdad16ede4d5e81985738ceb4",
        "patch": "diff --git a/django/contrib/admin/options.py b/django/contrib/admin/options.py\n--- a/django/contrib/admin/options.py\n+++ b/django/contrib/admin/options.py\n@@ -2037,10 +2037,13 @@ def __init__(self, parent_model, admin_site):\n         self.opts = self.model._meta\n         self.has_registered_model = admin_site.is_registered(self.model)\n         super().__init__()\n+        if self.verbose_name_plural is None:\n+            if self.verbose_name is None:\n+                self.verbose_name_plural = self.model._meta.verbose_name_plural\n+            else:\n+                self.verbose_name_plural = format_lazy('{}s', self.verbose_name)\n         if self.verbose_name is None:\n             self.verbose_name = self.model._meta.verbose_name\n-        if self.verbose_name_plural is None:\n-            self.verbose_name_plural = self.model._meta.verbose_name_plural\n \n     @property\n     def media(self):\n",
        "pr_link": "https://github.com/django/django/pull/13710"
    }
}