{
    "task_id": "sympy__sympy-17139",
    "setup_info": {
        "repo_path": "/home/haifeng/projects/reverse-prompt/SWE-bench/testbed/sympy__sympy/setup_sympy__sympy__1.5",
        "env_name": "setup_sympy__sympy__1.5",
        "pre_install": [],
        "install": "python -m pip install -e .",
        "test_cmd": "bin/test -C --verbose sympy/simplify/tests/test_fu.py sympy/simplify/tests/test_simplify.py"
    },
    "task_info": {
        "instance_id": "sympy__sympy-17139",
        "base_commit": "1d3327b8e90a186df6972991963a5ae87053259d",
        "hints_text": "",
        "created_at": "2019-07-01T19:17:18Z",
        "test_patch": "diff --git a/sympy/simplify/tests/test_fu.py b/sympy/simplify/tests/test_fu.py\n--- a/sympy/simplify/tests/test_fu.py\n+++ b/sympy/simplify/tests/test_fu.py\n@@ -76,6 +76,10 @@ def test__TR56():\n     assert T(sin(x)**6, sin, cos, h, 6, True) == sin(x)**6\n     assert T(sin(x)**8, sin, cos, h, 10, True) == (-cos(x)**2 + 1)**4\n \n+    # issue 17137\n+    assert T(sin(x)**I, sin, cos, h, 4, True) == sin(x)**I\n+    assert T(sin(x)**(2*I + 1), sin, cos, h, 4, True) == sin(x)**(2*I + 1)\n+\n \n def test_TR5():\n     assert TR5(sin(x)**2) == -cos(x)**2 + 1\ndiff --git a/sympy/simplify/tests/test_simplify.py b/sympy/simplify/tests/test_simplify.py\n--- a/sympy/simplify/tests/test_simplify.py\n+++ b/sympy/simplify/tests/test_simplify.py\n@@ -811,6 +811,11 @@ def test_issue_15965():\n     assert simplify(B) == bnew\n \n \n+def test_issue_17137():\n+    assert simplify(cos(x)**I) == cos(x)**I\n+    assert simplify(cos(x)**(2 + 3*I)) == cos(x)**(2 + 3*I)\n+\n+\n def test_issue_7971():\n     z = Integral(x, (x, 1, 1))\n     assert z != 0\n",
        "repo": "sympy/sympy",
        "problem_statement": "simplify(cos(x)**I): Invalid comparison of complex I (fu.py)\n```\r\n>>> from sympy import *\r\n>>> x = Symbol('x')\r\n>>> print(simplify(cos(x)**I))\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/home/e/se/sympy/simplify/simplify.py\", line 587, in simplify\r\n    expr = trigsimp(expr, deep=True)\r\n  File \"/home/e/se/sympy/simplify/trigsimp.py\", line 508, in trigsimp\r\n    return trigsimpfunc(expr)\r\n  File \"/home/e/se/sympy/simplify/trigsimp.py\", line 501, in <lambda>\r\n    'matching': (lambda x: futrig(x)),\r\n  File \"/home/e/se/sympy/simplify/trigsimp.py\", line 1101, in futrig\r\n    e = bottom_up(e, lambda x: _futrig(x, **kwargs))\r\n  File \"/home/e/se/sympy/simplify/simplify.py\", line 1081, in bottom_up\r\n    rv = F(rv)\r\n  File \"/home/e/se/sympy/simplify/trigsimp.py\", line 1101, in <lambda>\r\n    e = bottom_up(e, lambda x: _futrig(x, **kwargs))\r\n  File \"/home/e/se/sympy/simplify/trigsimp.py\", line 1169, in _futrig\r\n    e = greedy(tree, objective=Lops)(e)\r\n  File \"/home/e/se/sympy/strategies/core.py\", line 115, in minrule\r\n    return min([rule(expr) for rule in rules], key=objective)\r\n  File \"/home/e/se/sympy/strategies/core.py\", line 115, in <listcomp>\r\n    return min([rule(expr) for rule in rules], key=objective)\r\n  File \"/home/e/se/sympy/strategies/core.py\", line 44, in chain_rl\r\n    expr = rule(expr)\r\n  File \"/home/e/se/sympy/simplify/fu.py\", line 566, in TR6\r\n    return _TR56(rv, cos, sin, lambda x: 1 - x, max=max, pow=pow)\r\n  File \"/home/e/se/sympy/simplify/fu.py\", line 524, in _TR56\r\n    return bottom_up(rv, _f)\r\n  File \"/home/e/se/sympy/simplify/simplify.py\", line 1081, in bottom_up\r\n    rv = F(rv)\r\n  File \"/home/e/se/sympy/simplify/fu.py\", line 504, in _f\r\n    if (rv.exp < 0) == True:\r\n  File \"/home/e/se/sympy/core/expr.py\", line 406, in __lt__\r\n    raise TypeError(\"Invalid comparison of complex %s\" % me)\r\nTypeError: Invalid comparison of complex I\r\n```\n",
        "version": "1.5",
        "FAIL_TO_PASS": [
            "test__TR56",
            "test_issue_17137"
        ],
        "PASS_TO_PASS": [
            "test_L",
            "test_Piecewise",
            "test_TR1",
            "test_TR10",
            "test_TR10i",
            "test_TR11",
            "test_TR12",
            "test_TR12i",
            "test_TR13",
            "test_TR14",
            "test_TR15_16_17",
            "test_TR2",
            "test_TR2i",
            "test_TR3",
            "test_TR5",
            "test_TR6",
            "test_TR7",
            "test_TR8",
            "test_TR9",
            "test_TRmorrie",
            "test_TRpower",
            "test_as_content_primitive",
            "test_besselsimp",
            "test_clear_coefficients",
            "test_diff",
            "test_extract_minus_sign",
            "test_fu",
            "test_hyper_as_trig",
            "test_hypersimp",
            "test_inequality_no_auto_simplify",
            "test_issue_13474",
            "test_issue_15965",
            "test_issue_3557",
            "test_issue_4194",
            "test_issue_5652",
            "test_issue_5950",
            "test_issue_6811",
            "test_issue_6920",
            "test_issue_7001",
            "test_issue_7263",
            "test_issue_9324_simplify",
            "test_issue_9398",
            "test_issue_9448",
            "test_issue_from_PR1599",
            "test_logcombine_1",
            "test_logcombine_complex_coeff",
            "test_nc_simplify",
            "test_nsimplify",
            "test_nthroot",
            "test_nthroot1",
            "test_objective",
            "test_polymorphism",
            "test_posify",
            "test_process_common_addends",
            "test_separatevars",
            "test_separatevars_advanced_factor",
            "test_signsimp",
            "test_simplify_complex",
            "test_simplify_expr",
            "test_simplify_fail1",
            "test_simplify_function_inverse",
            "test_simplify_issue_1308",
            "test_simplify_measure",
            "test_simplify_other",
            "test_simplify_ratio",
            "test_simplify_rational",
            "test_trig_split"
        ],
        "environment_setup_commit": "70381f282f2d9d039da860e391fe51649df2779d",
        "patch": "diff --git a/sympy/simplify/fu.py b/sympy/simplify/fu.py\n--- a/sympy/simplify/fu.py\n+++ b/sympy/simplify/fu.py\n@@ -500,6 +500,8 @@ def _f(rv):\n         # change is not going to allow a simplification as far as I can tell.\n         if not (rv.is_Pow and rv.base.func == f):\n             return rv\n+        if not rv.exp.is_real:\n+            return rv\n \n         if (rv.exp < 0) == True:\n             return rv\n",
        "pr_link": "https://github.com/sympy/sympy/pull/17139"
    }
}