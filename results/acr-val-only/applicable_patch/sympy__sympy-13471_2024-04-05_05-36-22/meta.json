{
    "task_id": "sympy__sympy-13471",
    "setup_info": {
        "repo_path": "/home/haifeng/projects/reverse-prompt/SWE-bench/testbed/sympy__sympy/setup_sympy__sympy__1.1",
        "env_name": "setup_sympy__sympy__1.1",
        "pre_install": [],
        "install": "python -m pip install -e .",
        "test_cmd": "bin/test -C --verbose sympy/core/tests/test_numbers.py"
    },
    "task_info": {
        "instance_id": "sympy__sympy-13471",
        "base_commit": "3546ac7ed78e1780c1a76929864bb33330055740",
        "hints_text": "",
        "created_at": "2017-10-17T22:52:35Z",
        "test_patch": "diff --git a/sympy/core/tests/test_numbers.py b/sympy/core/tests/test_numbers.py\n--- a/sympy/core/tests/test_numbers.py\n+++ b/sympy/core/tests/test_numbers.py\n@@ -582,6 +582,12 @@ def test_Float_issue_2107():\n     assert S.Zero + b + (-b) == 0\n \n \n+def test_Float_from_tuple():\n+    a = Float((0, '1L', 0, 1))\n+    b = Float((0, '1', 0, 1))\n+    assert a == b\n+\n+\n def test_Infinity():\n     assert oo != 1\n     assert 1*oo == oo\n",
        "repo": "sympy/sympy",
        "problem_statement": "Python 2->3 pickle fails with float-containing expressions\nDumping a pickled sympy expression containing a float in Python 2, then loading it in Python 3 generates an error.\r\n\r\nHere is a minimum working example, verified with sympy git commit 3546ac7 (master at time of writing), Python 2.7 and Python 3.6:\r\n\r\n```python\r\npython2 -c 'import pickle; import sympy; x = sympy.symbols(\"x\"); print pickle.dumps(x + 1.0, 2)' | python3 -c 'import pickle; import sys; print(pickle.loads(sys.stdin.buffer.read()))'\r\n```\r\n\r\nand the result:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"<string>\", line 1, in <module>\r\n  File \"/Users/alex/git/VU/sympy/sympy/core/numbers.py\", line 1045, in __new__\r\n    num[1] = long(num[1], 16)\r\nValueError: invalid literal for int() with base 16: '1L'\r\n```\n",
        "version": "1.1",
        "FAIL_TO_PASS": [
            "test_Float_from_tuple"
        ],
        "PASS_TO_PASS": [
            "test_Catalan_EulerGamma_prec",
            "test_Div_By_Zero",
            "test_Float",
            "test_Float_RealElement",
            "test_Float_default_to_highprec_from_str",
            "test_Float_eq",
            "test_Float_eval",
            "test_Float_gcd_lcm_cofactors",
            "test_Float_idempotence",
            "test_Float_issue_2107",
            "test_GoldenRatio_expand",
            "test_Infinity",
            "test_Infinity_2",
            "test_Infinity_inequations",
            "test_IntegerInteger",
            "test_Integer_as_index",
            "test_Integer_factors",
            "test_Integer_new",
            "test_Integer_precision",
            "test_Mul_Infinity_Zero",
            "test_NaN",
            "test_NumberSymbol_comparison",
            "test_Number_new",
            "test_Rational_cmp",
            "test_Rational_factors",
            "test_Rational_gcd_lcm_cofactors",
            "test_Rational_int",
            "test_Rational_new",
            "test_abs1",
            "test_accept_int",
            "test_as_content_primitive",
            "test_bug_sqrt",
            "test_comp",
            "test_comparisons_with_unknown_type",
            "test_conversion_to_mpmath",
            "test_divmod",
            "test_dont_accept_str",
            "test_float_mpf",
            "test_golden_ratio_rewrite_as_sqrt",
            "test_hashing_sympy_integers",
            "test_igcd",
            "test_igcd2",
            "test_igcd_lehmer",
            "test_igcdex",
            "test_ilcm",
            "test_int",
            "test_int_NumberSymbols",
            "test_integer_nthroot_overflow",
            "test_integers_cache",
            "test_invert_numbers",
            "test_isqrt",
            "test_issue_10020",
            "test_issue_10063",
            "test_issue_3321",
            "test_issue_3423",
            "test_issue_3449",
            "test_issue_3692",
            "test_issue_4107",
            "test_issue_4122",
            "test_issue_4172",
            "test_issue_4611",
            "test_issue_6349",
            "test_issue_6640",
            "test_issue_7742",
            "test_issue_9491",
            "test_latex",
            "test_long",
            "test_mod",
            "test_mod_inverse",
            "test_mpf_norm",
            "test_no_len",
            "test_pi_Pi",
            "test_powers",
            "test_powers_Float",
            "test_powers_Integer",
            "test_powers_Rational",
            "test_real_bug",
            "test_relational",
            "test_seterr",
            "test_simplify_AlgebraicNumber",
            "test_special_numbers",
            "test_zoo"
        ],
        "environment_setup_commit": "ec9e3c0436fbff934fa84e22bf07f1b3ef5bfac3",
        "patch": "diff --git a/sympy/core/numbers.py b/sympy/core/numbers.py\n--- a/sympy/core/numbers.py\n+++ b/sympy/core/numbers.py\n@@ -1042,6 +1042,11 @@ def __new__(cls, num, dps=None, prec=None, precision=None):\n                 # it's a hexadecimal (coming from a pickled object)\n                 # assume that it is in standard form\n                 num = list(num)\n+                # If we're loading an object pickled in Python 2 into\n+                # Python 3, we may need to strip a tailing 'L' because\n+                # of a shim for int on Python 3, see issue #13470.\n+                if num[1].endswith('L'):\n+                    num[1] = num[1][:-1]\n                 num[1] = long(num[1], 16)\n                 _mpf_ = tuple(num)\n             else:\n",
        "pr_link": "https://github.com/sympy/sympy/pull/13471"
    }
}