{
    "task_id": "sympy__sympy-14317",
    "setup_info": {
        "repo_path": "/media/media0/yuntong/SWE-bench/testbed/sympy__sympy/setup_sympy__sympy__1.1",
        "env_name": "setup_sympy__sympy__1.1",
        "pre_install": [],
        "install": "python -m pip install -e .",
        "test_cmd": "bin/test -C --verbose sympy/printing/tests/test_latex.py"
    },
    "task_info": {
        "instance_id": "sympy__sympy-14317",
        "base_commit": "fb536869fb7aa28b2695ad7a3b70949926b291c4",
        "hints_text": "",
        "created_at": "2018-02-24T10:05:10Z",
        "test_patch": "diff --git a/sympy/printing/tests/test_latex.py b/sympy/printing/tests/test_latex.py\n--- a/sympy/printing/tests/test_latex.py\n+++ b/sympy/printing/tests/test_latex.py\n@@ -1132,11 +1132,20 @@ def test_latex_Poly():\n     assert latex(Poly(x**2 + 2 * x, x)) == \\\n         r\"\\operatorname{Poly}{\\left( x^{2} + 2 x, x, domain=\\mathbb{Z} \\right)}\"\n     assert latex(Poly(x/y, x)) == \\\n-        r\"\\operatorname{Poly}{\\left( \\frac{x}{y}, x, domain=\\mathbb{Z}\\left(y\\right) \\right)}\"\n+        r\"\\operatorname{Poly}{\\left( \\frac{1}{y} x, x, domain=\\mathbb{Z}\\left(y\\right) \\right)}\"\n     assert latex(Poly(2.0*x + y)) == \\\n         r\"\\operatorname{Poly}{\\left( 2.0 x + 1.0 y, x, y, domain=\\mathbb{R} \\right)}\"\n \n \n+def test_latex_Poly_order():\n+    assert latex(Poly([a, 1, b, 2, c, 3], x)) == \\\n+        '\\\\operatorname{Poly}{\\\\left( a x^{5} + x^{4} + b x^{3} + 2 x^{2} + c x + 3, x, domain=\\\\mathbb{Z}\\\\left[a, b, c\\\\right] \\\\right)}'\n+    assert latex(Poly([a, 1, b+c, 2, 3], x)) == \\\n+        '\\\\operatorname{Poly}{\\\\left( a x^{4} + x^{3} + \\\\left(b + c\\\\right) x^{2} + 2 x + 3, x, domain=\\\\mathbb{Z}\\\\left[a, b, c\\\\right] \\\\right)}'\n+    assert latex(Poly(a*x**3 + x**2*y - x*y - c*y**3 - b*x*y**2 + y - a*x + b, (x, y))) == \\\n+        '\\\\operatorname{Poly}{\\\\left( a x^{3} + x^{2}y -  b xy^{2} - xy -  a x -  c y^{3} + y + b, x, y, domain=\\\\mathbb{Z}\\\\left[a, b, c\\\\right] \\\\right)}'\n+\n+\n def test_latex_ComplexRootOf():\n     assert latex(rootof(x**5 + x + 3, 0)) == \\\n         r\"\\operatorname{CRootOf} {\\left(x^{5} + x + 3, 0\\right)}\"\n",
        "repo": "sympy/sympy",
        "problem_statement": "LaTeX printer does not use the same order of monomials as pretty and str \nWhen printing a Poly, the str and pretty printers use the logical order of monomials, from highest to lowest degrees. But latex printer does not. \r\n```\r\n>>> var('a b c x')\r\n>>> p = Poly([a, 1, b, 2, c, 3], x)\r\n>>> p\r\nPoly(a*x**5 + x**4 + b*x**3 + 2*x**2 + c*x + 3, x, domain='ZZ[a,b,c]')\r\n>>> pretty(p)\r\n\"Poly(a*x**5 + x**4 + b*x**3 + 2*x**2 + c*x + 3, x, domain='ZZ[a,b,c]')\"\r\n>>> latex(p)\r\n'\\\\operatorname{Poly}{\\\\left( a x^{5} + b x^{3} + c x + x^{4} + 2 x^{2} + 3, x, domain=\\\\mathbb{Z}\\\\left[a, b, c\\\\right] \\\\right)}'\r\n```\n",
        "version": "1.1",
        "FAIL_TO_PASS": [
            "test_latex_Poly",
            "test_latex_Poly_order"
        ],
        "PASS_TO_PASS": [
            "test_Adjoint",
            "test_Hadamard",
            "test_MatrixElement_printing",
            "test_MatrixSymbol_printing",
            "test_Modules",
            "test_Mul",
            "test_PolynomialRingBase",
            "test_Pow",
            "test_PrettyPoly",
            "test_Quaternion_latex_printing",
            "test_QuotientRing",
            "test_TensorProduct_printing",
            "test_Tr",
            "test_WedgeProduct_printing",
            "test_ZeroMatrix",
            "test_boolean_args_order",
            "test_builtin_no_args",
            "test_builtins_without_args",
            "test_categories",
            "test_custom_symbol_names",
            "test_function_subclass_different_name",
            "test_greek_symbols",
            "test_hyper_printing",
            "test_imaginary",
            "test_integral_transforms",
            "test_issue_10489",
            "test_issue_12886",
            "test_issue_13651",
            "test_issue_2934",
            "test_issue_3568",
            "test_issue_6853",
            "test_issue_7117",
            "test_issue_7180",
            "test_issue_8409",
            "test_lamda",
            "test_latex",
            "test_latex_AccumuBounds",
            "test_latex_Complement",
            "test_latex_ComplexRegion",
            "test_latex_ComplexRootOf",
            "test_latex_Complexes",
            "test_latex_ConditionSet",
            "test_latex_Contains",
            "test_latex_DiracDelta",
            "test_latex_Float",
            "test_latex_FormalPowerSeries",
            "test_latex_FourierSeries",
            "test_latex_FracElement",
            "test_latex_Heaviside",
            "test_latex_ImageSet",
            "test_latex_Integers",
            "test_latex_KroneckerDelta",
            "test_latex_Lambda",
            "test_latex_LeviCivita",
            "test_latex_Matrix",
            "test_latex_MatrixSlice",
            "test_latex_NDimArray",
            "test_latex_Naturals",
            "test_latex_Naturals0",
            "test_latex_Piecewise",
            "test_latex_PolyElement",
            "test_latex_RandomDomain",
            "test_latex_Range",
            "test_latex_RootSum",
            "test_latex_SetExpr",
            "test_latex_SingularityFunction",
            "test_latex_UnevaluatedExpr",
            "test_latex_basic",
            "test_latex_bessel",
            "test_latex_brackets",
            "test_latex_builtins",
            "test_latex_commutator",
            "test_latex_cycle",
            "test_latex_derivatives",
            "test_latex_dict",
            "test_latex_emptyset",
            "test_latex_euler",
            "test_latex_fresnel",
            "test_latex_functions",
            "test_latex_greek_functions",
            "test_latex_indexed",
            "test_latex_integrals",
            "test_latex_intervals",
            "test_latex_inverse",
            "test_latex_issue_4381",
            "test_latex_issue_4576",
            "test_latex_limits",
            "test_latex_list",
            "test_latex_log",
            "test_latex_matrix_with_functions",
            "test_latex_mul_symbol",
            "test_latex_numbers",
            "test_latex_order",
            "test_latex_permutation",
            "test_latex_pow_fraction",
            "test_latex_product",
            "test_latex_productset",
            "test_latex_rational",
            "test_latex_sequences",
            "test_latex_sets",
            "test_latex_subs",
            "test_latex_sum",
            "test_latex_symbols",
            "test_latex_symmetric_difference",
            "test_latex_union",
            "test_latex_vector_expressions",
            "test_matAdd",
            "test_matMul",
            "test_mode",
            "test_modifiers",
            "test_noncommutative",
            "test_other_symbols",
            "test_printmethod",
            "test_settings",
            "test_translate",
            "test_units"
        ],
        "environment_setup_commit": "ec9e3c0436fbff934fa84e22bf07f1b3ef5bfac3",
        "patch": "diff --git a/sympy/printing/latex.py b/sympy/printing/latex.py\n--- a/sympy/printing/latex.py\n+++ b/sympy/printing/latex.py\n@@ -1813,7 +1813,50 @@ def _print_PolynomialRingBase(self, expr):\n \n     def _print_Poly(self, poly):\n         cls = poly.__class__.__name__\n-        expr = self._print(poly.as_expr())\n+        terms = []\n+        for monom, coeff in poly.terms():\n+            s_monom = ''\n+            for i, exp in enumerate(monom):\n+                if exp > 0:\n+                    if exp == 1:\n+                        s_monom += self._print(poly.gens[i])\n+                    else:\n+                        s_monom += self._print(pow(poly.gens[i], exp))\n+\n+            if coeff.is_Add:\n+                if s_monom:\n+                    s_coeff = r\"\\left(%s\\right)\" % self._print(coeff)\n+                else:\n+                    s_coeff = self._print(coeff)\n+            else:\n+                if s_monom:\n+                    if coeff is S.One:\n+                        terms.extend(['+', s_monom])\n+                        continue\n+\n+                    if coeff is S.NegativeOne:\n+                        terms.extend(['-', s_monom])\n+                        continue\n+\n+                s_coeff = self._print(coeff)\n+\n+            if not s_monom:\n+                s_term = s_coeff\n+            else:\n+                s_term = s_coeff + \" \" + s_monom\n+\n+            if s_term.startswith('-'):\n+                terms.extend(['-', s_term[1:]])\n+            else:\n+                terms.extend(['+', s_term])\n+\n+        if terms[0] in ['-', '+']:\n+            modifier = terms.pop(0)\n+\n+            if modifier == '-':\n+                terms[0] = '-' + terms[0]\n+\n+        expr = ' '.join(terms)\n         gens = list(map(self._print, poly.gens))\n         domain = \"domain=%s\" % self._print(poly.get_domain())\n \n",
        "pr_link": "https://github.com/sympy/sympy/pull/14317"
    }
}