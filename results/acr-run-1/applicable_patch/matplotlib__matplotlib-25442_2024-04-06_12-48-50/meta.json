{
    "task_id": "matplotlib__matplotlib-25442",
    "setup_info": {
        "repo_path": "/media/media0/yuntong/SWE-bench/testbed/matplotlib__matplotlib/setup_matplotlib__matplotlib__3.7",
        "env_name": "setup_matplotlib__matplotlib__3.7",
        "pre_install": [],
        "install": "python -m pip install -e .",
        "test_cmd": "pytest --no-header -rA --tb=no -p no:cacheprovider lib/matplotlib/tests/test_offsetbox.py"
    },
    "task_info": {
        "instance_id": "matplotlib__matplotlib-25442",
        "base_commit": "73394f2b11321e03a5df199ec0196f27a728b0b0",
        "hints_text": "Can you report to https://github.com/anntzer/mplcursors/issues?  I'll close here but feel free to open an issue if a Matplotlib bug is identified.  ",
        "created_at": "2023-03-12T21:58:08Z",
        "test_patch": "diff --git a/lib/matplotlib/tests/test_offsetbox.py b/lib/matplotlib/tests/test_offsetbox.py\n--- a/lib/matplotlib/tests/test_offsetbox.py\n+++ b/lib/matplotlib/tests/test_offsetbox.py\n@@ -450,3 +450,11 @@ def test_paddedbox():\n     pb = PaddedBox(ta, pad=15, draw_frame=True)\n     ab = AnchoredOffsetbox('lower right', child=pb)\n     ax.add_artist(ab)\n+\n+\n+def test_remove_draggable():\n+    fig, ax = plt.subplots()\n+    an = ax.annotate(\"foo\", (.5, .5))\n+    an.draggable(True)\n+    an.remove()\n+    MouseEvent(\"button_release_event\", fig.canvas, 1, 1)._process()\n",
        "repo": "matplotlib/matplotlib",
        "problem_statement": "[Bug]: Attribute Error combining matplotlib 3.7.1 and mplcursor on data selection\n### Bug summary\r\n\r\nIf you combine mplcursor and matplotlib 3.7.1, you'll get an `AttributeError: 'NoneType' object has no attribute 'canvas'` after clicking a few data points. Henceforth, selecting a new data point will trigger the same traceback. Otherwise, it works fine. \r\n\r\n### Code for reproduction\r\n\r\n```python\r\nimport numpy as np\r\nimport matplotlib.pyplot as plt\r\nimport mplcursors as mpl\r\n\r\nx = np.arange(1, 11)    \r\ny1 = x\r\n\r\nplt.scatter(x,y1)\r\n\r\nmpl.cursor()\r\nplt.show()\r\n```\r\n\r\n\r\n### Actual outcome\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\MrAni\\Python\\miniconda3\\lib\\site-packages\\matplotlib\\cbook\\__init__.py\", line 304, in process\r\n    func(*args, **kwargs)\r\n  File \"C:\\Users\\MrAni\\Python\\miniconda3\\lib\\site-packages\\matplotlib\\offsetbox.py\", line 1550, in on_release\r\n    if self._check_still_parented() and self.got_artist:\r\n  File \"C:\\Users\\MrAni\\Python\\miniconda3\\lib\\site-packages\\matplotlib\\offsetbox.py\", line 1560, in _check_still_parented\r\n    self.disconnect()\r\n  File \"C:\\Users\\MrAni\\Python\\miniconda3\\lib\\site-packages\\matplotlib\\offsetbox.py\", line 1568, in disconnect\r\n    self.canvas.mpl_disconnect(cid)\r\n  File \"C:\\Users\\MrAni\\Python\\miniconda3\\lib\\site-packages\\matplotlib\\offsetbox.py\", line 1517, in <lambda>\r\n    canvas = property(lambda self: self.ref_artist.figure.canvas)\r\nAttributeError: 'NoneType' object has no attribute 'canvas'\r\n```\r\n\r\n### Expected outcome\r\n\r\nNo terminal output\r\n\r\n### Additional information\r\n\r\nUsing matplotlib 3.7.0 or lower works fine. Using a conda install or pip install doesn't affect the output. \r\n\r\n### Operating system\r\n\r\nWindows 11 and Windwos 10 \r\n\r\n### Matplotlib Version\r\n\r\n3.7.1\r\n\r\n### Matplotlib Backend\r\n\r\nQtAgg\r\n\r\n### Python version\r\n\r\n3.9.16\r\n\r\n### Jupyter version\r\n\r\n_No response_\r\n\r\n### Installation\r\n\r\nconda\n",
        "version": "3.7",
        "FAIL_TO_PASS": [
            "lib/matplotlib/tests/test_offsetbox.py::test_remove_draggable"
        ],
        "PASS_TO_PASS": [
            "lib/matplotlib/tests/test_offsetbox.py::test_anchoredtext_horizontal_alignment[png]",
            "lib/matplotlib/tests/test_offsetbox.py::test_annotationbbox_extents",
            "lib/matplotlib/tests/test_offsetbox.py::test_annotationbbox_properties",
            "lib/matplotlib/tests/test_offsetbox.py::test_arrowprops_copied",
            "lib/matplotlib/tests/test_offsetbox.py::test_expand_with_tight_layout",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal--1--1-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal--1--1-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal--1--1-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal--1--1-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal--1-0-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal--1-0-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal--1-0-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal--1-0-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal--1-100-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal--1-100-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal--1-100-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal--1-100-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal--1-250-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal--1-250-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal--1-250-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal--1-250-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal--1-None-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal--1-None-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal--1-None-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal--1-None-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-0--1-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-0--1-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-0--1-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-0--1-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-0-0-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-0-0-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-0-0-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-0-0-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-0-100-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-0-100-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-0-100-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-0-100-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-0-250-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-0-250-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-0-250-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-0-250-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-0-None-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-0-None-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-0-None-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-0-None-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-1--1-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-1--1-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-1--1-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-1--1-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-1-0-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-1-0-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-1-0-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-1-0-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-1-100-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-1-100-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-1-100-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-1-100-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-1-250-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-1-250-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-1-250-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-1-250-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-1-None-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-1-None-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-1-None-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-1-None-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-250--1-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-250--1-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-250--1-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-250--1-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-250-0-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-250-0-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-250-0-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-250-0-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-250-100-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-250-100-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-250-100-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-250-100-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-250-250-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-250-250-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-250-250-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-250-250-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-250-None-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-250-None-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-250-None-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[equal-250-None-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand--1--1-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand--1--1-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand--1--1-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand--1--1-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand--1-0-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand--1-0-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand--1-0-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand--1-0-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand--1-100-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand--1-100-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand--1-100-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand--1-100-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand--1-250-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand--1-250-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand--1-250-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand--1-250-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand--1-None-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand--1-None-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand--1-None-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand--1-None-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-0--1-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-0--1-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-0--1-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-0--1-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-0-0-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-0-0-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-0-0-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-0-0-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-0-100-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-0-100-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-0-100-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-0-100-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-0-250-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-0-250-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-0-250-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-0-250-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-0-None-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-0-None-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-0-None-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-0-None-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-1--1-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-1--1-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-1--1-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-1--1-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-1-0-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-1-0-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-1-0-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-1-0-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-1-100-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-1-100-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-1-100-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-1-100-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-1-250-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-1-250-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-1-250-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-1-250-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-1-None-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-1-None-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-1-None-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-1-None-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-250--1-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-250--1-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-250--1-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-250--1-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-250-0-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-250-0-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-250-0-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-250-0-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-250-100-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-250-100-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-250-100-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-250-100-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-250-250-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-250-250-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-250-250-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-250-250-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-250-None-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-250-None-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-250-None-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[expand-250-None-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed--1--1-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed--1--1-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed--1--1-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed--1--1-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed--1-0-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed--1-0-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed--1-0-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed--1-0-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed--1-100-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed--1-100-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed--1-100-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed--1-100-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed--1-250-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed--1-250-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed--1-250-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed--1-250-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed--1-None-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed--1-None-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed--1-None-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed--1-None-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-0--1-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-0--1-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-0--1-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-0--1-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-0-0-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-0-0-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-0-0-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-0-0-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-0-100-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-0-100-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-0-100-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-0-100-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-0-250-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-0-250-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-0-250-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-0-250-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-0-None-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-0-None-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-0-None-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-0-None-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-1--1-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-1--1-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-1--1-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-1--1-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-1-0-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-1-0-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-1-0-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-1-0-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-1-100-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-1-100-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-1-100-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-1-100-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-1-250-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-1-250-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-1-250-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-1-250-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-1-None-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-1-None-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-1-None-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-1-None-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-250--1-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-250--1-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-250--1-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-250--1-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-250-0-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-250-0-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-250-0-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-250-0-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-250-100-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-250-100-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-250-100-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-250-100-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-250-250-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-250-250-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-250-250-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-250-250-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-250-None-widths0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-250-None-widths1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-250-None-widths2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets[fixed-250-None-widths3]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets_equal[widths0-6-None-expected0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets_equal[widths1-2-None-expected1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets_equal[widths2-None-1-expected2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets_equal_total_none_sep_none",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets_expand[widths0-None-None-expected0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets_expand[widths1-10-1-expected1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets_expand[widths2-5-1-expected2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets_fixed[widths0-None-1-expected0]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets_fixed[widths1-10-1-expected1]",
            "lib/matplotlib/tests/test_offsetbox.py::test_get_packed_offsets_fixed[widths2-5-1-expected2]",
            "lib/matplotlib/tests/test_offsetbox.py::test_offsetbox_clip_children",
            "lib/matplotlib/tests/test_offsetbox.py::test_offsetbox_clipping[pdf]",
            "lib/matplotlib/tests/test_offsetbox.py::test_offsetbox_clipping[png]",
            "lib/matplotlib/tests/test_offsetbox.py::test_offsetbox_loc_codes",
            "lib/matplotlib/tests/test_offsetbox.py::test_packers[baseline]",
            "lib/matplotlib/tests/test_offsetbox.py::test_packers[bottom]",
            "lib/matplotlib/tests/test_offsetbox.py::test_packers[center]",
            "lib/matplotlib/tests/test_offsetbox.py::test_packers[left]",
            "lib/matplotlib/tests/test_offsetbox.py::test_packers[right]",
            "lib/matplotlib/tests/test_offsetbox.py::test_packers[top]",
            "lib/matplotlib/tests/test_offsetbox.py::test_paddedbox[png]",
            "lib/matplotlib/tests/test_offsetbox.py::test_paddedbox_default_values",
            "lib/matplotlib/tests/test_offsetbox.py::test_picking[axes",
            "lib/matplotlib/tests/test_offsetbox.py::test_picking[data-draw]",
            "lib/matplotlib/tests/test_offsetbox.py::test_picking[data-image]",
            "lib/matplotlib/tests/test_offsetbox.py::test_picking[data-text]",
            "lib/matplotlib/tests/test_offsetbox.py::test_textarea_properties",
            "lib/matplotlib/tests/test_offsetbox.py::test_textarea_set_text[pdf]",
            "lib/matplotlib/tests/test_offsetbox.py::test_textarea_set_text[png]",
            "lib/matplotlib/tests/test_offsetbox.py::test_zorder"
        ],
        "environment_setup_commit": "0849036fd992a2dd133a0cffc3f84f58ccf1840f",
        "patch": "diff --git a/lib/matplotlib/offsetbox.py b/lib/matplotlib/offsetbox.py\n--- a/lib/matplotlib/offsetbox.py\n+++ b/lib/matplotlib/offsetbox.py\n@@ -1500,16 +1500,23 @@ def __init__(self, ref_artist, use_blit=False):\n             ref_artist.set_picker(True)\n         self.got_artist = False\n         self._use_blit = use_blit and self.canvas.supports_blit\n-        self.cids = [\n-            self.canvas.callbacks._connect_picklable(\n-                'pick_event', self.on_pick),\n-            self.canvas.callbacks._connect_picklable(\n-                'button_release_event', self.on_release),\n+        callbacks = ref_artist.figure._canvas_callbacks\n+        self._disconnectors = [\n+            functools.partial(\n+                callbacks.disconnect, callbacks._connect_picklable(name, func))\n+            for name, func in [\n+                (\"pick_event\", self.on_pick),\n+                (\"button_release_event\", self.on_release),\n+                (\"motion_notify_event\", self.on_motion),\n+            ]\n         ]\n \n     # A property, not an attribute, to maintain picklability.\n     canvas = property(lambda self: self.ref_artist.figure.canvas)\n \n+    cids = property(lambda self: [\n+        disconnect.args[0] for disconnect in self._disconnectors[:2]])\n+\n     def on_motion(self, evt):\n         if self._check_still_parented() and self.got_artist:\n             dx = evt.x - self.mouse_x\n@@ -1536,16 +1543,12 @@ def on_pick(self, evt):\n                 self.ref_artist.draw(\n                     self.ref_artist.figure._get_renderer())\n                 self.canvas.blit()\n-            self._c1 = self.canvas.callbacks._connect_picklable(\n-                \"motion_notify_event\", self.on_motion)\n             self.save_offset()\n \n     def on_release(self, event):\n         if self._check_still_parented() and self.got_artist:\n             self.finalize_offset()\n             self.got_artist = False\n-            self.canvas.mpl_disconnect(self._c1)\n-\n             if self._use_blit:\n                 self.ref_artist.set_animated(False)\n \n@@ -1558,14 +1561,8 @@ def _check_still_parented(self):\n \n     def disconnect(self):\n         \"\"\"Disconnect the callbacks.\"\"\"\n-        for cid in self.cids:\n-            self.canvas.mpl_disconnect(cid)\n-        try:\n-            c1 = self._c1\n-        except AttributeError:\n-            pass\n-        else:\n-            self.canvas.mpl_disconnect(c1)\n+        for disconnector in self._disconnectors:\n+            disconnector()\n \n     def save_offset(self):\n         pass\n",
        "pr_link": "https://github.com/matplotlib/matplotlib/pull/25442"
    }
}